<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Angular on Rails - Basic Setup and Deploy | VZhang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="How to setup Angular with Rails
There are a lot of way you can integrate Angular with Rails, a common way is put Angular inside the Asset pipeline. It’s easy to integrate that way but the code base">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular on Rails - Basic Setup and Deploy">
<meta property="og:url" content="http://vs-zhang.github.io/2014/12/10/Angular-on-Rails/">
<meta property="og:site_name" content="VZhang's Blog">
<meta property="og:description" content="How to setup Angular with Rails
There are a lot of way you can integrate Angular with Rails, a common way is put Angular inside the Asset pipeline. It’s easy to integrate that way but the code base">
<meta property="og:image" content="https://36.media.tumblr.com/f3db51b38c8d9ba44edf7b15d2dfc4d5/tumblr_nl47qeEnQY1unxngeo1_540.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Angular on Rails - Basic Setup and Deploy">
<meta name="twitter:description" content="How to setup Angular with Rails
There are a lot of way you can integrate Angular with Rails, a common way is put Angular inside the Asset pipeline. It’s easy to integrate that way but the code base">

  
    <link rel="alternative" href="/atom.xml" title="VZhang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="https://41.media.tumblr.com/7ecbe0601ffcbc667bb04b4e2829acf3/tumblr_nl47z2ytqQ1unxngeo1_500.jpg">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars0.githubusercontent.com/u/3893244?v=3&amp;amp;s=460" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Vincent Zhang</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Tech &amp;&amp; Learn &amp;&amp; Fun</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menus</li>
						<li>Tags</li>
						
						
						<li>About me</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">All Blogs</a></li>
				        
							<li><a href="/instagram">Photos</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/vs-zhang" title="github">github</a>
					        
								<a class="linkedin" target="_blank" href="https://www.linkedin.com/pub/vincent-zhang/76/b99/219/en" title="linkedin">linkedin</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/-Test-TDD/" style="font-size: 10.00px;">-Test -TDD</a><a href="/tags/-Test-TDD/" style="font-size: 10.00px;">-Test, -TDD</a><a href="/tags/BDD/" style="font-size: 12.50px;">BDD</a><a href="/tags/CI/" style="font-size: 12.50px;">CI</a><a href="/tags/Capybara/" style="font-size: 15.00px;">Capybara</a><a href="/tags/Data/" style="font-size: 12.50px;">Data</a><a href="/tags/FactoryGirl/" style="font-size: 12.50px;">FactoryGirl</a><a href="/tags/JK/" style="font-size: 15.00px;">JK</a><a href="/tags/Projects/" style="font-size: 12.50px;">Projects</a><a href="/tags/RSpec/" style="font-size: 12.50px;">RSpec</a><a href="/tags/Rails/" style="font-size: 10.00px;">Rails</a><a href="/tags/TDD/" style="font-size: 12.50px;">TDD</a><a href="/tags/Test/" style="font-size: 17.50px;">Test</a><a href="/tags/Test-TDD/" style="font-size: 10.00px;">Test TDD</a><a href="/tags/Test-TDD/" style="font-size: 10.00px;">Test, TDD</a><a href="/tags/angular/" style="font-size: 15.00px;">angular</a><a href="/tags/capybara/" style="font-size: 10.00px;">capybara</a><a href="/tags/engine/" style="font-size: 15.00px;">engine</a><a href="/tags/gem/" style="font-size: 15.00px;">gem</a><a href="/tags/hexo/" style="font-size: 12.50px;">hexo</a><a href="/tags/rails/" style="font-size: 20.00px;">rails</a><a href="/tags/rspec/" style="font-size: 10.00px;">rspec</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Vincent Zhang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars0.githubusercontent.com/u/3893244?v=3&amp;amp;s=460" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Vincent Zhang</h1>
			</hgroup>
			
			<p class="header-subtitle">Tech &amp;&amp; Learn &amp;&amp; Fun</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">All Blogs</a></li>
		        
					<li><a href="/instagram">Photos</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/vs-zhang" title="github">github</a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/pub/vincent-zhang/76/b99/219/en" title="linkedin">linkedin</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-Angular-on-Rails" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/12/10/Angular-on-Rails/" class="article-date">
  	<time datetime="2014-12-10T18:28:36.000Z" itemprop="datePublished">Dec 10 2014</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Angular on Rails - Basic Setup and Deploy
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rails/">rails</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <div style="text-align:center" markdown="1"><br><img src="https://36.media.tumblr.com/f3db51b38c8d9ba44edf7b15d2dfc4d5/tumblr_nl47qeEnQY1unxngeo1_540.png" alt="angular+rails"><br></div>

<h1 id="How_to_setup_Angular_with_Rails">How to setup Angular with Rails</h1>
<p>There are a lot of way you can integrate Angular with Rails, a common way is put Angular inside the Asset pipeline. It’s easy to integrate that way but the code base is quite mess at the later point. Recently, I found a way to use Yeomen generator and rails-api to work as front-end and back-end together.<br>Here’s some Pros and Cons for this way:</p>
<h5 id="Pros:">Pros:</h5>
<ul>
<li>Separate struct and codebase for front-end and back-end</li>
<li>Get rid of unused rails component like erb view template </li>
<li>No more need to fresh for front-end change</li>
</ul>
<h5 id="Cons:">Cons:</h5>
<ul>
<li>have to deal with csrf token </li>
<li>need to setup the proxy</li>
<li>hard to deploy </li>
</ul>
<p><a id="more"></a><br><br></p>
<h2 id="Back-end_Part">Back-end Part</h2>
<p><br></p>
<h4 id="1-_Install_Rails-api">1. Install Rails-api</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem <span class="operator"><span class="keyword">install</span> rails-api</span></div></pre></td></tr></table></figure>

<h4 id="2-_Use_rails-api_to_generate_a_app">2. Use rails-api to generate a app</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails-api my_app</div></pre></td></tr></table></figure>

<h4 id="3-_Get_into_the_project_directory-">3. Get into the project directory.</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> my_app</div></pre></td></tr></table></figure>

<h4 id="4-_Setup_the_Database/Rspec">4. Setup the Database/Rspec</h4>
<p>After you use rails-api to set up the back-end, the back-end part is done. But if you want to user other kind of database or test framwork, you can set it up by yourself, just like a normal rails app. </p>
<p><br></p>
<h2 id="Front-end_Part">Front-end Part</h2>
<p>The front end will be using <a href="http://yeoman.io/" target="_blank" rel="external">Yeoman</a>, a great front-end tool. So we need npm to install yeoman, if you dont have npm installed in your machine, in mac osx <code>brew install npm</code>.</p>
<h4 id="5-_Install_Yeoman_and_Generator-angular">5. Install Yeoman and Generator-angular</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm <span class="operator"><span class="keyword">install</span> -g yo</span></div><div class="line">npm <span class="keyword">install</span> -g generator-angular</div></pre></td></tr></table></figure>

<h4 id="6-_Make_a_client_file_to_let_client-code_live_(but_you_can_call_what_ever_you_want)">6. Make a client file to let client-code live (but you can call what ever you want)</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">mkdir</span> client</div><div class="line"><span class="keyword">cd</span> client</div></pre></td></tr></table></figure>

<h4 id="7-_Generator_the_yeoman_app">7. Generator the yeoman app</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">yo</span> angular my_app</div></pre></td></tr></table></figure>

<p>And after a lot of npm console output, your client app is good to go. Right now you can use <code>grunt serve</code> to make the yeoman app runing.</p>
<p>But you will find out it’s not the thing you want. Since it’s not communicate properly right now with the back-end. OK, let’s make them talk.</p>
<p><br></p>
<h2 id="Connect_the_Front-end_and_back-end">Connect the Front-end and back-end</h2>
<p><br></p>
<h4 id="8-_Make_Front-End_public_file">8. Make Front-End public file</h4>
<p>As you know, yeoman app dist is #{Rails.root}/client/dist, and Rails front-end is in #{Rails.root}/public. </p>
<p>So first of all, we need to set the grunt dist file to the Rails Public file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Configurable paths for the application</span></div><div class="line"><span class="keyword">var</span> appConfig = {</div><div class="line">  app: <span class="built_in">require</span>(<span class="string">'./bower.json'</span>).appPath || <span class="string">'app'</span>,</div><div class="line">  dist: <span class="string">'../public'</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>But when you try to do a <code>grunt build</code> it will show the warning: <span style="color: blue"> Warning: Cannot delete files outside the current working directory. Use —force to continue.</span></p>
<p>So, after some search, I found a npm plugin called grunt-force. Install grunt-force first by npm install —save, then before your egisterTask, add this line <code>grunt.loadNpmTasks(&#39;grunt-force&#39;);</code> Then on the build task setup, add a <code>&#39;force:on&#39;</code>. So your build task is something like<br><br></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">grunt.registerTask(<span class="attribute">'build</span>', [</div><div class="line">   <span class="attribute">'force</span>:<span class="keyword">on</span>',</div><div class="line">   (the rest <span class="keyword">of</span> your build task)</div><div class="line"> ]);</div></pre></td></tr></table></figure>

<p>If your still get a warning about <span style="color: red">compass</span>, just try <span style="color: red"><code>gem install compass</code></span></p>
<p><br></p>
<h4 id="9-_Setting_up_a_proxy_9000_-&gt;_3000">9. Setting up a proxy 9000 -&gt; 3000</h4>
<p>Then the yeoman app is listen for port 9000, and Rails is listen for port 3000(default), so we have to let the angular app(port 9000) call Rails app (port 3000). So we need to make the yeoman app know to call port 3000 when 9000 is called.</p>
<p>There’s a plugin called grunt-connect-proxy. <code>npm install --save grunt-connect-proxy</code></p>
<p>Then go back to your grunt file#connect</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">connect: {</div><div class="line">      options: {</div><div class="line">        port: 9000,</div><div class="line">        hostname: 'localhost',  # <span class="operator"><span class="keyword">Change</span> this <span class="keyword">to</span> your <span class="keyword">server</span> IP</span></div><div class="line">        livereload: <span class="number">35729</span></div><div class="line">      },</div><div class="line">      proxies: [{</div><div class="line">        context: <span class="string">'/api'</span>,        # <span class="keyword">all</span> the API <span class="keyword">call</span> will be under localhost:<span class="number">3000</span>/api</div><div class="line">        host: <span class="string">'localhost'</span>,</div><div class="line">        port: <span class="number">3000</span>              # Your Rails port <span class="built_in">number</span></div><div class="line">      }],</div><div class="line">      (rest <span class="keyword">of</span> the setting)</div><div class="line">      }</div></pre></td></tr></table></figure>


<p> OK, you’re good to go. Now when you’re calling localhost:9000/api/users/1, it will automatic get direct to localhost:3000/api/users/1. Then we make the frond-end and back-end can work together. The next big problem is deployment and make the authentication working. Please check for the part II for that.</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/01/12/angular-on-rails-2/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Angular on Rails - Authentication (Draft)
        
      </div>
    </a>
  
  
    <a href="/2014/11/30/TDD-Data-with-FactoryGirl/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Data Association with FactoryGirl</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>





<section id="comments">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'tvzhang'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Vincent Zhang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>

<script src="/js/main.js" type="text/javascript"></script>







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>